<!-- Найти API банков рб (нб обязательно) и с их помощью перевести для 4 валют(евро, доллар, рос. рубль, бел. рубль):
1) деньги во все валюты на сейчас
2) деньги во все валюты по истории курсов валют-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script>
            var history = new Object;
            var currency = new Object;
            var toWrite = "";
            var now = new Date;
            var month;
            var date;
            var url;
            var startDate = new Date;
            var endDate = new Date;
            $(document).ready(function(){
                $.ajax({url:"http://www.nbrb.by/api/exrates/rates?periodicity=0", dataType:"json", success:function(data){
                    currency["BYN"] =[ 1,1,"Белорусский рубль",0];
                    data.forEach(elem => {
                        currency[elem.Cur_Abbreviation] = [elem.Cur_OfficialRate, elem.Cur_Scale,elem.Cur_Name, elem.Cur_ID];
                    });
                    toWrite = "";
                    for(key in currency){
                        toWrite += key +': <input id="'+key+'" class="curNow" type="text" textalign:"right"> x'+currency[key][1]+" "+currency[key][2]+' <br> <br>';
                    };
                    $("#todayCur").html(toWrite);
                    if(now.getMonth() < 10) month = "0"+now.getMonth();
                    else month = now.getMonth();
                    if(now.getDate() < 10) date = "0"+now.getDate();
                    else date = now.getDate();
                    toWrite = "<input type='date' id='hisStart'  min='2016-01-01' max='"+now.getFullYear()+"-"+month+"-"+date+"'>";
                    toWrite += "<input type='date'id='hisEnd'  min='2016-01-01' max='"+now.getFullYear()+"-"+month+"-"+date+"'>";
                    toWrite +="<select id='chCur'>"
                    for(key in currency){
                        if(key != "BYN")toWrite += "<option value='"+currency[key][3]+"'>x"+currency[key][1]+" "+currency[key][2]+"</option>"
                    }
                    toWrite +="</select>";
                    toWrite+="<button type='button' id='showCurHistory'>Show currency history</button>";
                    toWrite+="<div id='showHistoryCur'></div> </div>";
                    $("#historyCur").html(toWrite);
                    $("#showCurHistory").click(function(){
                        startDate = $("#hisStart").val();
                        endDate = $("#hisEnd").val();
                        curId =$("select").val();
                        url ="http://www.nbrb.by/API/ExRates/Rates/Dynamics/"+curId+"?startDate="+startDate+"&endDate="+endDate;
                        console.log(url);
                        $.getJSON(url,function(data){
                            toWrite = "<ul>";
                            console.log(data);
                            data.forEach(element => {
                                toWrite +="<li>"+element.Date.substring(0,10)+" "+element.Cur_OfficialRate+"</li>";
                            });
                            toWrite+= "</ul>"
                            $("#showHistoryCur").html(toWrite);
                        })
                    })

                    $("input").keyup(function(){
                        var cur = $(this).attr("id");
                        var money = $(this).val() * currency[cur][0];
                        $(".curNow:not(#"+cur+")").val(function(){
                            var id =  $(this).attr("id");
                            return money / currency[id][0];
                        })
                    })
                }})
                    $("#showToday").click(function(){
                        $("#todayCur").show();
                        $("#historyCur").hide();

                    })
                    $("#showHistory").click(function(){
                        $("#todayCur").hide();
                        $("#historyCur").show();
                    })
            });
        </script>
    </head>
    <body>
        <button type="button" id="showToday">Show today currencies exchange</button>
        <button type="button" id="showHistory">Show history of currencies exchange</button><br> <br>
        <div id="todayCur" hidden></div>
        <div id="historyCur" hidden>
    </body>
</html>
